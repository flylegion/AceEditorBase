<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Monaco Editor</title>
    <style>
      html, body, #container {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background-color: #1e1e1e;
      }

      #container {
        transform: scale(0.75);
        transform-origin: top left;
        width: 133.33%;
        height: 133.33%;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
    <script>
      require.config({ paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs' }});
      require(['vs/editor/editor.main'], function () {
        window.editor = monaco.editor.create(document.getElementById('container'), {
          value: '',
          language: 'javascript',
          theme: 'vs-dark',
          fontSize: 12,
        });

        // Forzar foco inicial para mostrar teclado
        editor.focus();

        // Notificar a React Native cuando se enfoca el editor
        editor.onDidFocusEditorText(() => {
          if (window.ReactNativeWebView) {
            window.ReactNativeWebView.postMessage('focused');
          }
        });

        // ðŸ§  Escuchar comandos desde React Native
        window.addEventListener('message', (event) => {
          try {
            const data = JSON.parse(event.data || '{}');
            const { type, payload } = data;

            if (type === 'SET_CODE') {
              editor.setValue(payload || '');
              editor.focus();
            } else if (type === 'SELECT_ALL') {
              editor.setSelection(editor.getModel().getFullModelRange());
              editor.focus();
            }
          } catch (e) {
            console.warn('Invalid message from React Native:', event.data);
          }
        });
      });
    </script>
  </body>
</html>
